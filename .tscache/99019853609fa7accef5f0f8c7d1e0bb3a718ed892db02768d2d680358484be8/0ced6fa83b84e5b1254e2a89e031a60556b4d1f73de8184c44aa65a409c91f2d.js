var fs = require('fs');
var common = require('./common');
common.register('cd', _cd, {});
//@
//@ ### cd([dir])
//@ Changes to directory `dir` for the duration of the script. Changes to home
//@ directory if no argument is supplied.
function _cd(options, dir) {
    if (!dir)
        dir = common.getUserHome();
    if (dir === '-') {
        if (!process.env.OLDPWD) {
            common.error('could not find previous directory');
        }
        else {
            dir = process.env.OLDPWD;
        }
    }
    try {
        var curDir = process.cwd();
        process.chdir(dir);
        process.env.OLDPWD = curDir;
    }
    catch (e) {
        // something went wrong, let's figure out the error
        var err;
        try {
            fs.statSync(dir); // if this succeeds, it must be some sort of file
            err = 'not a directory: ' + dir;
        }
        catch (e2) {
            err = 'no such file or directory: ' + dir;
        }
        if (err)
            common.error(err);
    }
    return '';
}
module.exports = _cd;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxpZmVkdVxcQXBwRGF0YVxcUm9hbWluZ1xcbnZtXFx2OC40LjBcXG5vZGVfbW9kdWxlc1xcZ2VuZXJhdG9yLXNwZWVkc2VlZFxcbm9kZV9tb2R1bGVzXFxzaGVsbGpzXFxzcmNcXGNkLmpzIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGlmZWR1XFxBcHBEYXRhXFxSb2FtaW5nXFxudm1cXHY4LjQuMFxcbm9kZV9tb2R1bGVzXFxnZW5lcmF0b3Itc3BlZWRzZWVkXFxub2RlX21vZHVsZXNcXHNoZWxsanNcXHNyY1xcY2QuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSSxFQUFFLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3ZCLElBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUVqQyxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDLENBQUM7QUFFL0IsR0FBRztBQUNILGlCQUFpQjtBQUNqQiw4RUFBOEU7QUFDOUUseUNBQXlDO0FBQ3pDLGFBQWEsT0FBTyxFQUFFLEdBQUc7SUFDdkIsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUM7UUFBQyxHQUFHLEdBQUcsTUFBTSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBRXJDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ2hCLEVBQUUsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1lBQ3hCLE1BQU0sQ0FBQyxLQUFLLENBQUMsbUNBQW1DLENBQUMsQ0FBQztRQUNwRCxDQUFDO1FBQUMsSUFBSSxDQUFDLENBQUM7WUFDTixHQUFHLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUM7UUFDM0IsQ0FBQztJQUNILENBQUM7SUFFRCxJQUFJLENBQUM7UUFDSCxJQUFJLE1BQU0sR0FBRyxPQUFPLENBQUMsR0FBRyxFQUFFLENBQUM7UUFDM0IsT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNuQixPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7SUFDOUIsQ0FBQztJQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDWCxtREFBbUQ7UUFDbkQsSUFBSSxHQUFHLENBQUM7UUFDUixJQUFJLENBQUM7WUFDSCxFQUFFLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsaURBQWlEO1lBQ25FLEdBQUcsR0FBRyxtQkFBbUIsR0FBRyxHQUFHLENBQUM7UUFDbEMsQ0FBQztRQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDWixHQUFHLEdBQUcsNkJBQTZCLEdBQUcsR0FBRyxDQUFDO1FBQzVDLENBQUM7UUFDRCxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUM7WUFBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzdCLENBQUM7SUFDRCxNQUFNLENBQUMsRUFBRSxDQUFDO0FBQ1osQ0FBQztBQUNELE1BQU0sQ0FBQyxPQUFPLEdBQUcsR0FBRyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGZzID0gcmVxdWlyZSgnZnMnKTtcbnZhciBjb21tb24gPSByZXF1aXJlKCcuL2NvbW1vbicpO1xuXG5jb21tb24ucmVnaXN0ZXIoJ2NkJywgX2NkLCB7fSk7XG5cbi8vQFxuLy9AICMjIyBjZChbZGlyXSlcbi8vQCBDaGFuZ2VzIHRvIGRpcmVjdG9yeSBgZGlyYCBmb3IgdGhlIGR1cmF0aW9uIG9mIHRoZSBzY3JpcHQuIENoYW5nZXMgdG8gaG9tZVxuLy9AIGRpcmVjdG9yeSBpZiBubyBhcmd1bWVudCBpcyBzdXBwbGllZC5cbmZ1bmN0aW9uIF9jZChvcHRpb25zLCBkaXIpIHtcbiAgaWYgKCFkaXIpIGRpciA9IGNvbW1vbi5nZXRVc2VySG9tZSgpO1xuXG4gIGlmIChkaXIgPT09ICctJykge1xuICAgIGlmICghcHJvY2Vzcy5lbnYuT0xEUFdEKSB7XG4gICAgICBjb21tb24uZXJyb3IoJ2NvdWxkIG5vdCBmaW5kIHByZXZpb3VzIGRpcmVjdG9yeScpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkaXIgPSBwcm9jZXNzLmVudi5PTERQV0Q7XG4gICAgfVxuICB9XG5cbiAgdHJ5IHtcbiAgICB2YXIgY3VyRGlyID0gcHJvY2Vzcy5jd2QoKTtcbiAgICBwcm9jZXNzLmNoZGlyKGRpcik7XG4gICAgcHJvY2Vzcy5lbnYuT0xEUFdEID0gY3VyRGlyO1xuICB9IGNhdGNoIChlKSB7XG4gICAgLy8gc29tZXRoaW5nIHdlbnQgd3JvbmcsIGxldCdzIGZpZ3VyZSBvdXQgdGhlIGVycm9yXG4gICAgdmFyIGVycjtcbiAgICB0cnkge1xuICAgICAgZnMuc3RhdFN5bmMoZGlyKTsgLy8gaWYgdGhpcyBzdWNjZWVkcywgaXQgbXVzdCBiZSBzb21lIHNvcnQgb2YgZmlsZVxuICAgICAgZXJyID0gJ25vdCBhIGRpcmVjdG9yeTogJyArIGRpcjtcbiAgICB9IGNhdGNoIChlMikge1xuICAgICAgZXJyID0gJ25vIHN1Y2ggZmlsZSBvciBkaXJlY3Rvcnk6ICcgKyBkaXI7XG4gICAgfVxuICAgIGlmIChlcnIpIGNvbW1vbi5lcnJvcihlcnIpO1xuICB9XG4gIHJldHVybiAnJztcbn1cbm1vZHVsZS5leHBvcnRzID0gX2NkO1xuIl19