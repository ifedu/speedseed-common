var path = require('path');
module.exports = function (basedir, relfiles) {
    if (relfiles) {
        var files = relfiles.map(function (r) {
            return path.resolve(basedir, r);
        });
    }
    else {
        var files = basedir;
    }
    var res = files.slice(1).reduce(function (ps, file) {
        if (!file.match(/^([A-Za-z]:)?\/|\\/)) {
            throw new Error('relative path without a basedir');
        }
        var xs = file.split(/\/+|\\+/);
        for (var i = 0; ps[i] === xs[i] && i < Math.min(ps.length, xs.length); i++)
            ;
        return ps.slice(0, i);
    }, files[0].split(/\/+|\\+/));
    // Windows correctly handles paths with forward-slashes
    return res.length > 1 ? res.join('/') : '/';
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxpZmVkdVxcQXBwRGF0YVxcUm9hbWluZ1xcbnZtXFx2OC40LjBcXG5vZGVfbW9kdWxlc1xcZ2VuZXJhdG9yLXNwZWVkc2VlZFxcbm9kZV9tb2R1bGVzXFxjb21tb25kaXJcXGluZGV4LmpzIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGlmZWR1XFxBcHBEYXRhXFxSb2FtaW5nXFxudm1cXHY4LjQuMFxcbm9kZV9tb2R1bGVzXFxnZW5lcmF0b3Itc3BlZWRzZWVkXFxub2RlX21vZHVsZXNcXGNvbW1vbmRpclxcaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSSxJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBRTNCLE1BQU0sQ0FBQyxPQUFPLEdBQUcsVUFBVSxPQUFPLEVBQUUsUUFBUTtJQUN4QyxFQUFFLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO1FBQ1gsSUFBSSxLQUFLLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUM7WUFDaEMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ3BDLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUNELElBQUksQ0FBQyxDQUFDO1FBQ0YsSUFBSSxLQUFLLEdBQUcsT0FBTyxDQUFDO0lBQ3hCLENBQUM7SUFFRCxJQUFJLEdBQUcsR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQUUsRUFBRSxJQUFJO1FBQzlDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNwQyxNQUFNLElBQUksS0FBSyxDQUFDLGlDQUFpQyxDQUFDLENBQUM7UUFDdkQsQ0FBQztRQUVELElBQUksRUFBRSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDL0IsR0FBRyxDQUFDLENBQ0EsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUNULEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLEVBQ3JELENBQUMsRUFBRTtZQUNOLENBQUM7UUFDRixNQUFNLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDMUIsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztJQUU5Qix1REFBdUQ7SUFDdkQsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsR0FBRyxDQUFBO0FBQy9DLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbInZhciBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChiYXNlZGlyLCByZWxmaWxlcykge1xuICAgIGlmIChyZWxmaWxlcykge1xuICAgICAgICB2YXIgZmlsZXMgPSByZWxmaWxlcy5tYXAoZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgICAgIHJldHVybiBwYXRoLnJlc29sdmUoYmFzZWRpciwgcik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIGZpbGVzID0gYmFzZWRpcjtcbiAgICB9XG4gICAgXG4gICAgdmFyIHJlcyA9IGZpbGVzLnNsaWNlKDEpLnJlZHVjZShmdW5jdGlvbiAocHMsIGZpbGUpIHtcbiAgICAgICAgaWYgKCFmaWxlLm1hdGNoKC9eKFtBLVphLXpdOik/XFwvfFxcXFwvKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdyZWxhdGl2ZSBwYXRoIHdpdGhvdXQgYSBiYXNlZGlyJyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHZhciB4cyA9IGZpbGUuc3BsaXQoL1xcLyt8XFxcXCsvKTtcbiAgICAgICAgZm9yIChcbiAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgIHBzW2ldID09PSB4c1tpXSAmJiBpIDwgTWF0aC5taW4ocHMubGVuZ3RoLCB4cy5sZW5ndGgpO1xuICAgICAgICAgICAgaSsrXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiBwcy5zbGljZSgwLCBpKTtcbiAgICB9LCBmaWxlc1swXS5zcGxpdCgvXFwvK3xcXFxcKy8pKTtcbiAgICBcbiAgICAvLyBXaW5kb3dzIGNvcnJlY3RseSBoYW5kbGVzIHBhdGhzIHdpdGggZm9yd2FyZC1zbGFzaGVzXG4gICAgcmV0dXJuIHJlcy5sZW5ndGggPiAxID8gcmVzLmpvaW4oJy8nKSA6ICcvJ1xufTtcbiJdfQ==