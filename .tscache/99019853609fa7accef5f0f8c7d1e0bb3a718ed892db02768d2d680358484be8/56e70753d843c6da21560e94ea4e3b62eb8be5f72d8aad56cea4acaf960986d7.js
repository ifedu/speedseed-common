'use strict';
var PassThrough = require('stream').PassThrough;
var zlib = require('zlib');
module.exports = function (res) {
    // TODO: use Array#includes when targeting Node.js 6
    if (['gzip', 'deflate'].indexOf(res.headers['content-encoding']) === -1) {
        return res;
    }
    var unzip = zlib.createUnzip();
    var stream = new PassThrough();
    stream.httpVersion = res.httpVersion;
    stream.headers = res.headers;
    stream.rawHeaders = res.rawHeaders;
    stream.trailers = res.trailers;
    stream.rawTrailers = res.rawTrailers;
    stream.setTimeout = res.setTimeout.bind(res);
    stream.statusCode = res.statusCode;
    stream.statusMessage = res.statusMessage;
    stream.socket = res.socket;
    unzip.on('error', function (err) {
        if (err.code === 'Z_BUF_ERROR') {
            stream.end();
            return;
        }
        stream.emit('error', err);
    });
    res.pipe(unzip).pipe(stream);
    return stream;
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxpZmVkdVxcQXBwRGF0YVxcUm9hbWluZ1xcbnZtXFx2OC40LjBcXG5vZGVfbW9kdWxlc1xcZ2VuZXJhdG9yLXNwZWVkc2VlZFxcbm9kZV9tb2R1bGVzXFx1bnppcC1yZXNwb25zZVxcaW5kZXguanMiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcaWZlZHVcXEFwcERhdGFcXFJvYW1pbmdcXG52bVxcdjguNC4wXFxub2RlX21vZHVsZXNcXGdlbmVyYXRvci1zcGVlZHNlZWRcXG5vZGVfbW9kdWxlc1xcdW56aXAtcmVzcG9uc2VcXGluZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFlBQVksQ0FBQztBQUNiLElBQU0sV0FBVyxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQyxXQUFXLENBQUM7QUFDbEQsSUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBRTdCLE1BQU0sQ0FBQyxPQUFPLEdBQUcsVUFBQSxHQUFHO0lBQ25CLG9EQUFvRDtJQUNwRCxFQUFFLENBQUMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxTQUFTLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3pFLE1BQU0sQ0FBQyxHQUFHLENBQUM7SUFDWixDQUFDO0lBRUQsSUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQ2pDLElBQU0sTUFBTSxHQUFHLElBQUksV0FBVyxFQUFFLENBQUM7SUFFakMsTUFBTSxDQUFDLFdBQVcsR0FBRyxHQUFHLENBQUMsV0FBVyxDQUFDO0lBQ3JDLE1BQU0sQ0FBQyxPQUFPLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQztJQUM3QixNQUFNLENBQUMsVUFBVSxHQUFHLEdBQUcsQ0FBQyxVQUFVLENBQUM7SUFDbkMsTUFBTSxDQUFDLFFBQVEsR0FBRyxHQUFHLENBQUMsUUFBUSxDQUFDO0lBQy9CLE1BQU0sQ0FBQyxXQUFXLEdBQUcsR0FBRyxDQUFDLFdBQVcsQ0FBQztJQUNyQyxNQUFNLENBQUMsVUFBVSxHQUFHLEdBQUcsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzdDLE1BQU0sQ0FBQyxVQUFVLEdBQUcsR0FBRyxDQUFDLFVBQVUsQ0FBQztJQUNuQyxNQUFNLENBQUMsYUFBYSxHQUFHLEdBQUcsQ0FBQyxhQUFhLENBQUM7SUFDekMsTUFBTSxDQUFDLE1BQU0sR0FBRyxHQUFHLENBQUMsTUFBTSxDQUFDO0lBRTNCLEtBQUssQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLFVBQUEsR0FBRztRQUNwQixFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxLQUFLLGFBQWEsQ0FBQyxDQUFDLENBQUM7WUFDaEMsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDO1lBQ2IsTUFBTSxDQUFDO1FBQ1IsQ0FBQztRQUVELE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQzNCLENBQUMsQ0FBQyxDQUFDO0lBRUgsR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7SUFFN0IsTUFBTSxDQUFDLE1BQU0sQ0FBQztBQUNmLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbmNvbnN0IFBhc3NUaHJvdWdoID0gcmVxdWlyZSgnc3RyZWFtJykuUGFzc1Rocm91Z2g7XG5jb25zdCB6bGliID0gcmVxdWlyZSgnemxpYicpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJlcyA9PiB7XG5cdC8vIFRPRE86IHVzZSBBcnJheSNpbmNsdWRlcyB3aGVuIHRhcmdldGluZyBOb2RlLmpzIDZcblx0aWYgKFsnZ3ppcCcsICdkZWZsYXRlJ10uaW5kZXhPZihyZXMuaGVhZGVyc1snY29udGVudC1lbmNvZGluZyddKSA9PT0gLTEpIHtcblx0XHRyZXR1cm4gcmVzO1xuXHR9XG5cblx0Y29uc3QgdW56aXAgPSB6bGliLmNyZWF0ZVVuemlwKCk7XG5cdGNvbnN0IHN0cmVhbSA9IG5ldyBQYXNzVGhyb3VnaCgpO1xuXG5cdHN0cmVhbS5odHRwVmVyc2lvbiA9IHJlcy5odHRwVmVyc2lvbjtcblx0c3RyZWFtLmhlYWRlcnMgPSByZXMuaGVhZGVycztcblx0c3RyZWFtLnJhd0hlYWRlcnMgPSByZXMucmF3SGVhZGVycztcblx0c3RyZWFtLnRyYWlsZXJzID0gcmVzLnRyYWlsZXJzO1xuXHRzdHJlYW0ucmF3VHJhaWxlcnMgPSByZXMucmF3VHJhaWxlcnM7XG5cdHN0cmVhbS5zZXRUaW1lb3V0ID0gcmVzLnNldFRpbWVvdXQuYmluZChyZXMpO1xuXHRzdHJlYW0uc3RhdHVzQ29kZSA9IHJlcy5zdGF0dXNDb2RlO1xuXHRzdHJlYW0uc3RhdHVzTWVzc2FnZSA9IHJlcy5zdGF0dXNNZXNzYWdlO1xuXHRzdHJlYW0uc29ja2V0ID0gcmVzLnNvY2tldDtcblxuXHR1bnppcC5vbignZXJyb3InLCBlcnIgPT4ge1xuXHRcdGlmIChlcnIuY29kZSA9PT0gJ1pfQlVGX0VSUk9SJykge1xuXHRcdFx0c3RyZWFtLmVuZCgpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHN0cmVhbS5lbWl0KCdlcnJvcicsIGVycik7XG5cdH0pO1xuXG5cdHJlcy5waXBlKHVuemlwKS5waXBlKHN0cmVhbSk7XG5cblx0cmV0dXJuIHN0cmVhbTtcbn07XG4iXX0=