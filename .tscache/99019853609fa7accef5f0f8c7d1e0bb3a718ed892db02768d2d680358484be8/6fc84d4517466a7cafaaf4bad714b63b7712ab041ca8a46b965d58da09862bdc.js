"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var https = require("https");
var SearchGenerators = /** @class */ (function () {
    function SearchGenerators() {
        var _this = this;
        this.getChoice = function (name, value) { return ({ name: name, value: value }); };
        this.searchResp = function (resp) {
            var obj = {
                data: ''
            };
            resp.on('data', _this.respData.bind(_this, obj));
            resp.on('end', _this.respEnd.bind(_this, obj));
            resp.on('error', _this.respError);
        };
        this.respData = function (obj, chunk) {
            obj.data += chunk;
        };
        this.respEnd = function (obj) {
            var json = JSON.parse(obj.data);
            for (var _i = 0, json_1 = json; _i < json_1.length; _i++) {
                var data = json_1[_i];
                _this.checkGeneratorSpeedSeed(data);
            }
        };
        this.isGeneratorSpeedseed = function (choice, data) {
            return (choice.name === "generator-" + data.name);
        };
        this.isNotBlackList = function (name) {
            var gs = 'generator-speedseed-';
            if (name === gs + "angular2-whitespace")
                return false;
            if (name === gs + "polymer-whitespace")
                return false;
            return true;
        };
        this.setOfficialGenerators();
        this.searchGenerators();
        return this.choices;
    }
    SearchGenerators.prototype.setOfficialGenerators = function () {
        var gs = 'generator-speedseed-';
        this.choices = [
            this.getChoice(gs + "multi-tic-tac-toe", 'multi-tic-tac-toe'),
            this.getChoice(gs + "cleanly-angular2-tour-of-heroes", 'cleanly-angular2-tour-of-heroes'),
            this.getChoice(gs + "cleanly-polymer-get-started", 'cleanly-polymer-get-started'),
            this.getChoice(gs + "cleanly-todomvc", 'cleanly-todomvc'),
            this.getChoice(gs + "cleanly-breakouts", 'cleanly-breakouts')
        ];
    };
    SearchGenerators.prototype.searchGenerators = function () {
        var yoJson = 'https://storage.googleapis.com/generators.yeoman.io/cache.json';
        https.get(yoJson, this.searchResp);
    };
    SearchGenerators.prototype.respError = function (err) { };
    SearchGenerators.prototype.checkGeneratorSpeedSeed = function (data) {
        if (this.isTplSpeedseed(data) &&
            !this.searchGeneratorsIncludes(data)) {
            this.choices.push({
                name: "generator-" + data.name,
                value: data.name.substring(10)
            });
        }
    };
    SearchGenerators.prototype.isTplSpeedseed = function (data) {
        var CHARS_TEMPLATING = 'speedseed-';
        var FIRST_CHARS_DATA = data.name.substring(0, CHARS_TEMPLATING.length);
        return FIRST_CHARS_DATA === CHARS_TEMPLATING;
    };
    SearchGenerators.prototype.searchGeneratorsIncludes = function (data) {
        var isFinded = false;
        for (var _i = 0, _a = this.choices; _i < _a.length; _i++) {
            var choice = _a[_i];
            if (this.isGeneratorSpeedseed(choice, data) &&
                this.isNotBlackList(choice.name)) {
                isFinded = true;
            }
        }
        return isFinded;
    };
    return SearchGenerators;
}());
exports.default = SearchGenerators;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxpZmVkdVxcQXBwRGF0YVxcUm9hbWluZ1xcbnZtXFx2OC40LjBcXG5vZGVfbW9kdWxlc1xcZ2VuZXJhdG9yLXNwZWVkc2VlZFxcZ2VuZXJhdG9yc1xcaW5zdGFsbFxcc2VhcmNoR2VuZXJhdG9ycy50cyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxpZmVkdVxcQXBwRGF0YVxcUm9hbWluZ1xcbnZtXFx2OC40LjBcXG5vZGVfbW9kdWxlc1xcZ2VuZXJhdG9yLXNwZWVkc2VlZFxcZ2VuZXJhdG9yc1xcaW5zdGFsbFxcc2VhcmNoR2VuZXJhdG9ycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLDZCQUE4QjtBQUU5QjtJQUdJO1FBQUEsaUJBS0M7UUFtQk8sY0FBUyxHQUFHLFVBQUMsSUFBUyxFQUFFLEtBQVUsSUFBSyxPQUFBLENBQUMsRUFBRSxJQUFJLE1BQUEsRUFBRSxLQUFLLE9BQUEsRUFBRSxDQUFDLEVBQWpCLENBQWlCLENBQUE7UUFReEQsZUFBVSxHQUFHLFVBQUMsSUFBUztZQUMzQixJQUFNLEdBQUcsR0FBUTtnQkFDYixJQUFJLEVBQUUsRUFBRTthQUNYLENBQUE7WUFFRCxJQUFJLENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxLQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxLQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQTtZQUM5QyxJQUFJLENBQUMsRUFBRSxDQUFDLEtBQUssRUFBRSxLQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQTtZQUM1QyxJQUFJLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxLQUFJLENBQUMsU0FBUyxDQUFDLENBQUE7UUFDcEMsQ0FBQyxDQUFBO1FBRU8sYUFBUSxHQUFHLFVBQUMsR0FBUSxFQUFFLEtBQVU7WUFDcEMsR0FBRyxDQUFDLElBQUksSUFBSSxLQUFLLENBQUE7UUFDckIsQ0FBQyxDQUFBO1FBRU8sWUFBTyxHQUFH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O1FBRXBCLEdBQUcsQ0FBQyxDQUFlLFVBQVksRUFBWixLQUFBLElBQUksQ0FBQyxPQUFPLEVBQVosY0FBWSxFQUFaLElBQVk7WUFBMUIsSUFBSSxNQUFNLFNBQUE7WUFDWCxFQUFFLENBQUMsQ0FDQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQztnQkFDdkMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUNuQyxDQUFDLENBQUMsQ0FBQztnQkFDQyxRQUFRLEdBQUcsSUFBSSxDQUFBO1lBQ25CLENBQUM7U0FDSjtRQUVELE1BQU0sQ0FBQyxRQUFRLENBQUE7SUFDbkIsQ0FBQztJQWFMLHVCQUFDO0FBQUQsQ0FBQyxBQXhHRCxJQXdHQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGh0dHBzIGZyb20gJ2h0dHBzJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZWFyY2hHZW5lcmF0b3JzIHtcbiAgICBwcml2YXRlIGNob2ljZXM6IGFueVxuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuc2V0T2ZmaWNpYWxHZW5lcmF0b3JzKClcbiAgICAgICAgdGhpcy5zZWFyY2hHZW5lcmF0b3JzKClcblxuICAgICAgICByZXR1cm4gdGhpcy5jaG9pY2VzXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXRPZmZpY2lhbEdlbmVyYXRvcnMoKSB7XG4gICAgICAgIGNvbnN0IGdzID0gJ2dlbmVyYXRvci1zcGVlZHNlZWQtJ1xuXG4gICAgICAgIHRoaXMuY2hvaWNlcyA9IFtcbiAgICAgICAgICAgIHRoaXMuZ2V0Q2hvaWNlKGAke2dzfW11bHRpLXRpYy10YWMtdG9lYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ211bHRpLXRpYy10YWMtdG9lJyksXG4gICAgICAgICAgICB0aGlzLmdldENob2ljZShgJHtnc31jbGVhbmx5LWFuZ3VsYXIyLXRvdXItb2YtaGVyb2VzYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2xlYW5seS1hbmd1bGFyMi10b3VyLW9mLWhlcm9lcycpLFxuICAgICAgICAgICAgdGhpcy5nZXRDaG9pY2UoYCR7Z3N9Y2xlYW5seS1wb2x5bWVyLWdldC1zdGFydGVkYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2xlYW5seS1wb2x5bWVyLWdldC1zdGFydGVkJyksXG4gICAgICAgICAgICB0aGlzLmdldENob2ljZShgJHtnc31jbGVhbmx5LXRvZG9tdmNgLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjbGVhbmx5LXRvZG9tdmMnKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0Q2hvaWNlKGAke2dzfWNsZWFubHktYnJlYWtvdXRzYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2xlYW5seS1icmVha291dHMnKVxuICAgICAgICBdXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRDaG9pY2UgPSAobmFtZTogYW55LCB2YWx1ZTogYW55KSA9PiAoeyBuYW1lLCB2YWx1ZSB9KVxuXG4gICAgcHJpdmF0ZSBzZWFyY2hHZW5lcmF0b3JzKCkge1xuICAgICAgICBjb25zdCB5b0pzb246IHN0cmluZyA9ICdodHRwczovL3N0b3JhZ2UuZ29vZ2xlYXBpcy5jb20vZ2VuZXJhdG9ycy55ZW9tYW4uaW8vY2FjaGUuanNvbidcblxuICAgICAgICBodHRwcy5nZXQoeW9Kc29uLCB0aGlzLnNlYXJjaFJlc3ApXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZWFyY2hSZXNwID0gKHJlc3A6IGFueSkgPT4ge1xuICAgICAgICBjb25zdCBvYmo6IGFueSA9IHtcbiAgICAgICAgICAgIGRhdGE6ICcnXG4gICAgICAgIH1cblxuICAgICAgICByZXNwLm9uKCdkYXRhJywgdGhpcy5yZXNwRGF0YS5iaW5kKHRoaXMsIG9iaikpXG4gICAgICAgIHJlc3Aub24oJ2VuZCcsIHRoaXMucmVzcEVuZC5iaW5kKHRoaXMsIG9iaikpXG4gICAgICAgIHJlc3Aub24oJ2Vycm9yJywgdGhpcy5yZXNwRXJyb3IpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZXNwRGF0YSA9IChvYmo6IGFueSwgY2h1bms6IGFueSkgPT4ge1xuICAgICAgICBvYmouZGF0YSArPSBjaHVua1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVzcEVuZCA9IChvYmo6IGFueSkgPT4ge1xuICAgICAgICBjb25zdCBqc29uOiBhbnkgPSBKU09OLnBhcnNlKG9iai5kYXRhKVxuXG4gICAgICAgIGZvciAobGV0IGRhdGEgb2YganNvbikge1xuICAgICAgICAgICAgdGhpcy5jaGVja0dlbmVyYXRvclNwZWVkU2VlZChkYXRhKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZXNwRXJyb3IoZXJyOiBhbnkpIHt9XG5cbiAgICBwcml2YXRlIGNoZWNrR2VuZXJhdG9yU3BlZWRTZWVkKGRhdGE6IGFueSkge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICB0aGlzLmlzVHBsU3BlZWRzZWVkKGRhdGEpICYmXG4gICAgICAgICAgICAhdGhpcy5zZWFyY2hHZW5lcmF0b3JzSW5jbHVkZXMoZGF0YSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgICB0aGlzLmNob2ljZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgbmFtZTogYGdlbmVyYXRvci0ke2RhdGEubmFtZX1gLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBkYXRhLm5hbWUuc3Vic3RyaW5nKDEwKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaXNUcGxTcGVlZHNlZWQoZGF0YTogYW55KSB7XG4gICAgICAgIGNvbnN0IENIQVJTX1RFTVBMQVRJTkcgPSAnc3BlZWRzZWVkLSdcbiAgICAgICAgY29uc3QgRklSU1RfQ0hBUlNfREFUQSA9IGRhdGEubmFtZS5zdWJzdHJpbmcoMCwgQ0hBUlNfVEVNUExBVElORy5sZW5ndGgpXG5cbiAgICAgICAgcmV0dXJuIEZJUlNUX0NIQVJTX0RBVEEgPT09IENIQVJTX1RFTVBMQVRJTkdcbiAgICB9XG5cbiAgICBwcml2YXRlIHNlYXJjaEdlbmVyYXRvcnNJbmNsdWRlcyhkYXRhOiBhbnkpIHtcbiAgICAgICAgbGV0IGlzRmluZGVkID0gZmFsc2VcblxuICAgICAgICBmb3IgKGxldCBjaG9pY2Ugb2YgdGhpcy5jaG9pY2VzKSB7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgdGhpcy5pc0dlbmVyYXRvclNwZWVkc2VlZChjaG9pY2UsIGRhdGEpICYmXG4gICAgICAgICAgICAgICAgdGhpcy5pc05vdEJsYWNrTGlzdChjaG9pY2UubmFtZSlcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIGlzRmluZGVkID0gdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGlzRmluZGVkXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpc0dlbmVyYXRvclNwZWVkc2VlZCA9IChjaG9pY2U6IGFueSwgZGF0YTogYW55KSA9PlxuICAgICAgICAoY2hvaWNlLm5hbWUgPT09IGBnZW5lcmF0b3ItJHtkYXRhLm5hbWV9YClcblxuICAgIHByaXZhdGUgaXNOb3RCbGFja0xpc3QgPSAobmFtZTogYW55KSA9PiB7XG4gICAgICAgIGNvbnN0IGdzID0gJ2dlbmVyYXRvci1zcGVlZHNlZWQtJ1xuXG4gICAgICAgIGlmIChuYW1lID09PSBgJHtnc31hbmd1bGFyMi13aGl0ZXNwYWNlYCkgcmV0dXJuIGZhbHNlXG4gICAgICAgIGlmIChuYW1lID09PSBgJHtnc31wb2x5bWVyLXdoaXRlc3BhY2VgKSByZXR1cm4gZmFsc2VcblxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbn1cbiJdfQ==