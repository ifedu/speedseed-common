'use strict';
var cbs = [];
var called = false;
function exit(exit, signal) {
    if (called) {
        return;
    }
    called = true;
    cbs.forEach(function (el) {
        el();
    });
    if (exit === true) {
        process.exit(128 + signal);
    }
}
;
module.exports = function (cb) {
    cbs.push(cb);
    if (cbs.length === 1) {
        process.once('exit', exit);
        process.once('SIGINT', exit.bind(null, true, 2));
        process.once('SIGTERM', exit.bind(null, true, 15));
    }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxpZmVkdVxcQXBwRGF0YVxcUm9hbWluZ1xcbnZtXFx2OC40LjBcXG5vZGVfbW9kdWxlc1xcZ2VuZXJhdG9yLXNwZWVkc2VlZFxcbm9kZV9tb2R1bGVzXFxleGl0LWhvb2tcXGluZGV4LmpzIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGlmZWR1XFxBcHBEYXRhXFxSb2FtaW5nXFxudm1cXHY4LjQuMFxcbm9kZV9tb2R1bGVzXFxnZW5lcmF0b3Itc3BlZWRzZWVkXFxub2RlX21vZHVsZXNcXGV4aXQtaG9va1xcaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxDQUFDO0FBRWIsSUFBSSxHQUFHLEdBQUcsRUFBRSxDQUFDO0FBQ2IsSUFBSSxNQUFNLEdBQUcsS0FBSyxDQUFDO0FBRW5CLGNBQWMsSUFBSSxFQUFFLE1BQU07SUFDekIsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUNaLE1BQU0sQ0FBQztJQUNSLENBQUM7SUFFRCxNQUFNLEdBQUcsSUFBSSxDQUFDO0lBRWQsR0FBRyxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUU7UUFDdkIsRUFBRSxFQUFFLENBQUM7SUFDTixDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxDQUFDLElBQUksS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQ25CLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxHQUFHLE1BQU0sQ0FBQyxDQUFDO0lBQzVCLENBQUM7QUFDRixDQUFDO0FBQUEsQ0FBQztBQUVGLE1BQU0sQ0FBQyxPQUFPLEdBQUcsVUFBVSxFQUFFO0lBQzVCLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7SUFFYixFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsTUFBTSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdEIsT0FBTyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDM0IsT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDakQsT0FBTyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDcEQsQ0FBQztBQUNGLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxudmFyIGNicyA9IFtdO1xudmFyIGNhbGxlZCA9IGZhbHNlO1xuXG5mdW5jdGlvbiBleGl0KGV4aXQsIHNpZ25hbCkge1xuXHRpZiAoY2FsbGVkKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Y2FsbGVkID0gdHJ1ZTtcblxuXHRjYnMuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHtcblx0XHRlbCgpO1xuXHR9KTtcblxuXHRpZiAoZXhpdCA9PT0gdHJ1ZSkge1xuXHRcdHByb2Nlc3MuZXhpdCgxMjggKyBzaWduYWwpO1xuXHR9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChjYikge1xuXHRjYnMucHVzaChjYik7XG5cblx0aWYgKGNicy5sZW5ndGggPT09IDEpIHtcblx0XHRwcm9jZXNzLm9uY2UoJ2V4aXQnLCBleGl0KTtcblx0XHRwcm9jZXNzLm9uY2UoJ1NJR0lOVCcsIGV4aXQuYmluZChudWxsLCB0cnVlLCAyKSk7XG5cdFx0cHJvY2Vzcy5vbmNlKCdTSUdURVJNJywgZXhpdC5iaW5kKG51bGwsIHRydWUsIDE1KSk7XG5cdH1cbn07XG4iXX0=